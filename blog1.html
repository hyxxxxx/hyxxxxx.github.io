<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="editormd.css"/>
    <link rel="stylesheet" href="editormd.min.css"/>
    <title>JVM配置参数</title>
</head>
<body>
<div class="editormd-preview" style="display: block; width: 1360px; top: 43px; height: 538px;">
    <div class="markdown-body editormd-preview-container editormd-preview-active" previewcontainer="true"
         style="padding: 20px;"><h3 id="h3-u5806u53C2u6570u914Du7F6E"><a name="堆参数配置" class="reference-link"></a><span
            class="header-link octicon octicon-link"></span>堆参数配置</h3>
        <ul>
            <li>-Xms：设置java程序启动时初始堆大小</li>
            <li>-Xmx：设置java程序能获得的最大堆大小</li>
            <li>-Xmn：可以设置新生代大小，一般会设置整个堆空间的1/3到1/4左右</li>
            <li>-XX:SurvivorRatio：用来设置新生代中eden空间和from/to空间的比例，值就是eden/from或者eden/to的比值</li>
            <li>-XX:NewRatio：设置老年代和新生代的比例，值就是老年代/新生代</li>
            <li>-XX:+HeapDumpOnOutOfMemoryError：使用该参数可以在内存溢出时导出整个堆信息</li>
            <li>-XX:HeapDumpPath：设置导出堆的存放路径</li>
            <li>-XX:+PrintCommandLineFlags：可以将隐式或者显示传给虚拟机的参数输出</li>
            <li>-XX:+UseAdaptiveSizePolicy：打开<strong>自适应模式</strong>，这种模式下，新生代大小、eden、from/to比例以及晋升老年代的年龄参数会被自动调整，以达到各个参数之间的平衡点（一般只用这一个参数就可以了）
            </li>
        </ul>
        <blockquote>
            <p><strong>可以直接将初始的堆大小与最大堆大小设置相等，好处在于可以减少程序运行时的垃圾回收次数，从而提高性能。</strong></p>
            <p>例如：Xmx20m -Xms20m -XX:+UseAdaptiveSizePolicy（自适应模式）</p>
        </blockquote>
        <h3 id="h3-u6808u53C2u6570u914Du7F6E"><a name="栈参数配置" class="reference-link"></a><span
                class="header-link octicon octicon-link"></span>栈参数配置</h3>
        <ul>
            <li>-Xss：指定线程的最大栈空间，整个参数也直接决定了函数可调用的最大深度</li>
        </ul>
        <h3 id="h3-u65B9u6CD5u533Au53C2u6570u914Du7F6E"><a name="方法区参数配置" class="reference-link"></a><span
                class="header-link octicon octicon-link"></span>方法区参数配置</h3>
        <ul>
            <li>-XX:MaxPermSize：配置最大方法区大小（默认是64m），这是值根据系统运行时有多少类产生来预估</li>
        </ul>
        <h3 id="h3-gc-"><a name="GC参数配置" class="reference-link"></a><span
                class="header-link octicon octicon-link"></span>GC参数配置</h3>
        <ul>
            <li>-XX:+PrintGC：虚拟器启动后，只要遇到GC就会打印日志</li>
            <li>-Xloggc:PATH：指定GC打印日志保存的路径（PATH:绝对路径）</li>
            <li>-XX:+PrintGCDetails：可以查看详细信息，包括各个区的情况</li>
            <li>-XX:MaxTenuringThreshold：配置经历多少次gc后进入老年代（默认是15次）</li>
            <li>-XX:PretenureSizeThreshold：当对象超过设置的大小时，直接进入老年代</li>
            <li>-XX:ParallelGCThreads：指定ParNew回收器工作时的线程数量，最好和计算机的CPU相当</li>
            <li>-XX:MaxGCPauseMillis：设置最大垃圾收集停顿时间</li>
            <li>-XX:GCTimeRatio：设置吞吐量大小，是0到100之间的整数（默认是99）</li>
            <li>-XX:+ParallelGCThreads：设置垃圾收集时的线程数量<h4 id="h4-u5783u573Eu56DEu6536u5668u79CDu7C7B"><a name="垃圾回收器种类"
                                                                                                      class="reference-link"></a><span
                    class="header-link octicon octicon-link"></span>垃圾回收器种类</h4>
                <pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code><span
                        class="pln">  </span><span class="pun">-</span><span class="pln">XX</span><span
                        class="pun">:+</span><span class="typ">UseSerialGC</span><span
                        class="pun">：使用串行回收器</span></code></li><li class="L1"><code><span class="pln">  </span><span
                        class="pun">-</span><span class="pln">XX</span><span class="pun">:+</span><span class="typ">UseParNewGC</span><span
                        class="pun">：新生代使用</span><span class="typ">ParNew</span><span
                        class="pun">并行回收器，老年代默认用串行回收器</span></code></li><li class="L2"><code><span class="pln">  </span><span
                        class="pun">-</span><span class="pln">XX</span><span class="pun">:</span><span class="typ">UseParallelGC</span><span
                        class="pun">：新生代使用复制算法的</span><span class="pln">GC</span><span
                        class="pun">，它非常关注系统的吞吐量（高并发业务使用）</span></code></li><li class="L3"><code><span
                        class="pln">  </span><span class="pun">-</span><span class="pln">XX</span><span
                        class="pun">:</span><span class="typ">UseParallelOldGC</span><span class="pun">：老年代使用标记压缩法的回收器，也关注吞吐量</span></code></li><li
                        class="L4"><code><span class="pln">  </span><span class="pun">-</span><span
                        class="pln">XX</span><span class="pun">:+</span><span class="typ">UseConcMarkSweepGC</span><span
                        class="pun">：</span><span class="pln">CMS</span><span class="pun">回收器（目前主流），并发标记清除，主要关注系统停顿时间，因为这不是独占回收器，所以要保证内存够用。它不会等到应用程序饱和才去回收，而是在指定阈值时回收</span></code></li><li
                        class="L5"><code><span class="pln">  </span><span class="pun">-</span><span
                        class="pln">XX</span><span class="pun">:+</span><span class="typ">UseG1GC</span><span
                        class="pun">：</span><span class="pln">G1</span><span class="pun">回收器（</span><span class="pln">jdk1</span><span
                        class="pun">.</span><span class="lit">7</span><span class="pun">后提出的），属于分代垃圾回收器，区分新生代和老年代，使用了分区算法</span></code></li></ol></pre>
            </li>
        </ul>
        <hr>
        <blockquote>
            <p>CMS回收器（目前主流）：并发标记清除，主要关注系统停顿时间，因为这不是独占回收器，所以要保证内存够用。它不会等到应用程序饱和才去回收，而是在指定阈值时回收</p>
            <ul>
                <li>-XX:+UseConcMarkSweepGC：开启</li>
                <li>-XX:ConcGCThreads：设置并发线程数量</li>
                <li>-XX:CMSInitiatingOccupancyFraction：指定垃圾收集工作的阈值（默认是68）</li>
                <li>-XX:+UseCMSCompactAtFullCollection：可以设置CMS回收完成后进行一次碎片整理</li>
                <li>-XX:CMSFullGCsBeforeCompaction：设置进行多少次CMS回收后，对内存进行一次压缩</li>
            </ul>
            <p>G1回收器（jdk1.7后提出的）：属于分代垃圾回收器，区分新生代和老年代，使用了分区算法</p>
            <ul>
                <li>-XX:+UseG1GC</li>
                <li>-XX:MaxGCPauseMillis</li>
                <li>-XX:ParallelGCThreads</li>
            </ul>
        </blockquote>
    </div>
</div>
</body>
</html>
